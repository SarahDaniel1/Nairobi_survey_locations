

<!DOCTYPE html>
<html>
<head>
  <title>Nairobi Sampled Hoods</title>
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {margin:0; font-family:Arial; background:#f0f4f8;}
    #controls {position:absolute; top:10px; left:10px; z-index:1000; background:white; padding:20px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.2);}
    select {padding:12px; font-size:16px; border:2px solid #4099ff; border-radius:8px; width:280px;}
    #map {height:100vh;}
    .stats {margin-top:10px; font-size:14px; color:#666;}
  </style>
</head>
<body>
  <div id="controls">
    <label>üè† Select Neighborhood: 
      <select id="hood-select" onchange="showSelectedHood()">
        <option value="">All Sampled Hoods (zoom out)</option>
      </select>
    </label>
    <div id="hood-stats" class="stats"></div>
  </div>
  <div id="map"></div>
  
  <script>
    var map = L.map("map").setView([-1.29, 36.82], 10);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

    var allHoodsData, currentLayer;

    fetch("hoods_sampled.geojson")
      .then(r => r.json())
      .then(data => {
        allHoodsData = data;

        // Draw all neighborhoods gray initially
        L.geoJSON(data, {
          style: {color: "#888", weight: 2, fillOpacity: 0.1}
        }).addTo(map);

        // Populate dropdown
        data.features.forEach(f => {
          var hoodName = f.properties.Name; // make sure this matches your GeoJSON property
          if(!hoodName) return;
          var option = document.createElement("option");
          option.value = hoodName;
          option.textContent = hoodName;
          document.getElementById("hood-select").appendChild(option);
        });
      });

    function showSelectedHood() {
      var selectedHood = document.getElementById("hood-select").value;

      if(currentLayer) map.removeLayer(currentLayer);

      if(!selectedHood){
        // Show all neighborhoods gray if none selected
        currentLayer = L.geoJSON(allHoodsData, {
          style: {color: "#888", weight: 2, fillOpacity: 0.1}
        }).addTo(map);
        map.setView([-1.29, 36.82], 10);
        document.getElementById("hood-stats").innerHTML = "";
        return;
      }

      // Filter selected neighborhood
      var selectedFeatures = allHoodsData.features.filter(f => 
        f.properties.Name === selectedHood
      );

      currentLayer = L.geoJSON(
        {type:"FeatureCollection", features:selectedFeatures},
        {
          style: {color:"#ff6b35", weight:5, fillOpacity:0.4}, // highlight orange
          onEachFeature: function(feat, layer){
            layer.bindPopup(`
              <b>${feat.properties.Name}</b><br>
              Barrier Quartile: ${feat.properties.barrier_quartile || "N/A"}<br>
              Income Level: ${feat.properties["Income Level"] || "N/A"}<br>
              Address: ${feat.properties.addresses || "N/A"}
            `);
          }
        }
      ).addTo(map);

      map.fitBounds(currentLayer.getBounds().pad(0.1));

      // Update stats panel
      var stats = selectedFeatures[0].properties;
      document.getElementById("hood-stats").innerHTML = `
        <b>Barrier Quartile:</b> ${stats.barrier_quartile || "N/A"}<br>
        <b>Income Level:</b> ${stats["Income Level"] || "N/A"}<br>
        <b>Address:</b> ${stats.addresses || "N/A"}
      `;
    }
  </script>
</body>
</html>
